(window["webpackJsonpvk-mini-drawings"]=window["webpackJsonpvk-mini-drawings"]||[]).push([[0],{208:function(e,t,a){e.exports=a(322)},287:function(e,t,a){},322:function(e,t,a){"use strict";a.r(t);a(209),a(235),a(237),a(238),a(240),a(241),a(242),a(243),a(244),a(245),a(246),a(247),a(249),a(250),a(251),a(252),a(253),a(254),a(255),a(256),a(257),a(258),a(260),a(261),a(262),a(263),a(264),a(265),a(266),a(267),a(268),a(269),a(270),a(271),a(272),a(273),a(274),a(275),a(276),a(277);var n,c,o,s=a(0),r=a.n(s),l=a(82),i=a.n(l),u=a(12),d=a.n(u),m=a(54),p=a.n(m),f=a(84),h=a(17),b=a(62),g=a.n(b),E=a(48),v=a.n(E),k=(a(286),a(287),a(40)),_=a.n(k),A=a(41),w=a.n(A),j=a(31),O=a.n(j),M=a(47),P=a.n(M),y=a(42),C=a.n(y),K=a(126),S=a.n(K),W=a(127),V=a.n(W),I=a(85),z=a.n(I),U=a(112),T=a.n(U),x=a(113),N=a.n(x),R=a(114),q=a.n(R),F=a(50),G=a.n(F),H=a(61),D=a.n(H),B=a(46),L=a.n(B),Y=a(115),J=a.n(Y),Q=(a(299),a(53)),X=a.n(Q),Z=a(116),$=a.n(Z),ee=function(e){var t=e.id,a=e.postArr,n=e.showPhoto,c=e.setActiveModal,o=e.groupInfo;Object(s.useEffect)((function(){}),[]);console.log(o);var l=function(e){for(var t=[],a=0;a<e.length;a++)"photo"===e[a].type&&t.push(e[a].photo);return t};return r.a.createElement(_.a,{id:t},r.a.createElement(w.a,null,"\u041b\u0435\u043d\u0442\u0430"),a.length>0&&a.map((function(e){if(!e.is_pinned)return r.a.createElement(P.a,{key:e.id},r.a.createElement(C.a,null,r.a.createElement(G.a,{before:r.a.createElement(L.a,{src:o&&o.photo_50,size:48}),description:(t=e.date,J()(1e3*t).format("DD.MM.YYYY  h:mm"))},r.a.createElement("a",{className:"text-decor-none",target:"_blank",href:"https://vk.com/moiresunke"},o&&o.name)),e.text,l(e.attachments).length>0&&r.a.createElement(C.a,null,r.a.createElement("div",{className:"photo-shell"},l(e.attachments).map((function(e){var t=e.sizes.length-1;return r.a.createElement("div",{className:"photo-div",key:e.id},r.a.createElement("img",{key:e.id,className:"photo-post",src:e.sizes[t].url,alt:"img",onClick:function(){return n(e.sizes[t].url)}}))}))),r.a.createElement(D.a,{wide:!0}),r.a.createElement("a",{target:"_blank",className:"fix-link",href:"https://vk.com/moiresunke?w=wall".concat(e.owner_id,"_").concat(e.id)}," ",r.a.createElement(O.a,{mode:"secondary",className:"fix-margin-icon"},"\u041e\u0431\u0441\u0443\u0434\u0438\u0442\u044c"))),r.a.createElement(X.a,{vertical:"bottom"},r.a.createElement(O.a,{before:r.a.createElement($.a,null),size:"xl",onClick:function(){return c("sendPost")}}," \u041f\u0440\u0435\u0434\u043b\u043e\u0436\u0438\u0442\u044c \u043d\u043e\u0432\u043e\u0441\u0442\u044c "))));var t})))},te=a(86),ae=a(117),ne=a.n(ae),ce=a(118),oe=a.n(ce),se=a(83),re=a.n(se),le=Object(te.b)(),ie=function(e){var t=e.id,a=e.photo,n=e.go;return r.a.createElement(_.a,{id:t},r.a.createElement(w.a,{left:r.a.createElement(re.a,{onClick:n,"data-to":"home"},le===te.a?r.a.createElement(ne.a,null):r.a.createElement(oe.a,null))}," "),r.a.createElement("img",{src:a,alt:"img",className:"photo-preview"}))},ue=a(63),de=a.n(ue),me=a(123),pe=a.n(me),fe=a(124),he=a.n(fe),be=a(125),ge=a.n(be),Ee=a(119),ve=a.n(Ee),ke=a(120),_e=a.n(ke),Ae=a(121),we=a.n(Ae),je=a(122),Oe=a.n(je),Me=function(e){var t=e.id,a=e.setPopout,n=e.userArr,c=e.lang,o=e.checkMessage,l=e.isMessagesFromGroupAllowed,i=e.setcheckMessage,u=Object(s.useState)(!1),m=Object(h.a)(u,2),p=m[0],f=m[1],b=function(e){d.a.send("VKWebAppCallAPIMethod",{method:"users.get",request_id:"getUsers",params:{user_ids:e,v:"5.103",fields:"photo_50",access_token:"85685eaa85685eaa85685eaa2d8504b3b58856885685eaad8e8ae5c720f4db08e7e9ee0",lang:c}})};Object(s.useEffect)((function(){a(r.a.createElement(v.a,{size:"large"})),function(e){fetch("https://spreadsheets.google.com/feeds/cells/1SX9lV4-URRyErZJT-tDc6-A4vbpMzTniQKtUsRk10kg/1/public/full?alt=json").then((function(e){return e.json()})).then((function(t){t&&e(function(e){for(var t=[],a=0;a<e.length;a++)t.push(e[a].content.$t);return t.join(",")}(t.feed.entry))}))}(b)}),[]),Object(s.useEffect)((function(){e.fetchedUser&&l()}),[e.fetchedUser]);var g=function(){var e,t;f(!0),setTimeout((function(){f(!1)}),(e=600,t=2e3,Math.floor(Math.random()*(t-e))+e))};return r.a.createElement(_.a,{id:t},r.a.createElement(w.a,null,"\u041a\u0430\u0442\u0430\u043b\u043e\u0433 \u0445\u0443\u0434\u043e\u0436\u043d\u0438\u043a\u043e\u0432"),r.a.createElement(P.a,{description:"\u0412\u044b \u0431\u0443\u0434\u0435\u0442\u0435 \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0432\u0430\u0436\u043d\u044b\u0435 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f",separator:"show"},r.a.createElement(G.a,{asideContent:r.a.createElement(_e.a,{checked:o,onChange:function(e){e.currentTarget.checked?(a(r.a.createElement(v.a,{size:"large"})),d.a.send("VKWebAppAllowMessagesFromGroup",{group_id:185650440,key:"dBuBKe1kFcdemzB"})):i(!1)}})},"Push-\u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f")),r.a.createElement(we.a,{onRefresh:function(){return g()},isFetching:p},r.a.createElement(P.a,null,r.a.createElement(Oe.a,null,n.map((function(e,t){return r.a.createElement(G.a,{key:t,target:"_blank",href:"https://vk.com/id".concat(e.id),before:r.a.createElement(L.a,{src:e.photo_50})},e.first_name," ",e.last_name)}))))),r.a.createElement(X.a,{vertical:"bottom"},r.a.createElement(O.a,{target:"_blanck",className:"button-fix",size:"xl",href:"https://vk.com/app5619682_-113161053#467432"}," \u041f\u043e\u043f\u0430\u0441\u0442\u044c \u0432 \u043a\u0430\u0442\u0430\u043b\u043e\u0433 ")))},Pe="c6f961fbc6f961fbc6f961fbf0c696cc53cc6f9c6f961fb98bd9f39d8cccff2eea6e9d3",ye=0,Ce=0,Ke=30,Se=!0,We=function(){var e=Object(s.useState)("post"),t=Object(h.a)(e,2),a=t[0],l=t[1],i=Object(s.useState)("home"),u=Object(h.a)(i,2),m=u[0],b=u[1],E=Object(s.useState)(null),k=Object(h.a)(E,2),_=k[0],A=k[1],w=Object(s.useState)(r.a.createElement(v.a,{size:"large"})),j=Object(h.a)(w,2),M=j[0],P=j[1],y=Object(s.useState)([]),K=Object(h.a)(y,2),W=K[0],I=K[1],U=Object(s.useState)("ru"),x=Object(h.a)(U,2),R=x[0],F=x[1],G=Object(s.useState)([]),H=Object(h.a)(G,2),D=H[0],B=H[1],Y=Object(s.useState)(""),J=Object(h.a)(Y,2),Q=J[0],X=J[1],Z=Object(s.useState)("subscription"),$=Object(h.a)(Z,2),te=$[0],ae=$[1],ne=Object(s.useState)(!1),ce=Object(h.a)(ne,2),oe=ce[0],se=ce[1],re=Object(s.useState)(null),le=Object(h.a)(re,2),ue=le[0],me=le[1],fe=Object(s.useState)(""),be=Object(h.a)(fe,2),Ee=be[0],ke=be[1],_e=Object(s.useState)(0),Ae=Object(h.a)(_e,2),we=Ae[0],je=Ae[1],Oe=Object(s.useState)(null),We=Object(h.a)(Oe,2),Ve=We[0],Ie=We[1];Object(s.useEffect)((function(){var e=new URLSearchParams(window.location.search);function t(){return(t=Object(f.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.send("VKWebAppGetUserInfo");case 2:t=e.sent,A(t),ye=t.id,P(null);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return F(e.get("vk_language")),d.a.subscribe((function(e){var t=e.detail,a=t.type,o=t.data;switch(a){case"VKWebAppUpdateConfig":var s=document.createAttribute("scheme");s.value=o.scheme?o.scheme:"client_light",document.body.attributes.setNamedItem(s);break;case"VKWebAppAllowMessagesFromGroupResult":case"VKWebAppAllowMessagesFromGroupFailed":P(null),Re();break;case"VKWebAppAccessTokenReceived":0===we&&(je(o.access_token),Ce=o.access_token,Be(ye,o.access_token));break;case"VKWebAppCallAPIMethodResult":switch(o.request_id){case"getUsers":P(null),I(o.response);break;case"getPosts":P(null),B(D.concat(o.response.items));break;case"checkMessage":P(null),0===o.response.is_allowed?se(!1):se(!0);break;case"userAlbums":var r="\u041c\u043e\u0438 \u0440\u0438\u0441\u0443\u043d\u043a\u0438, \u043d\u0430\u0431\u0440\u043e\u0441\u043a\u0438",l=o.response.items;if(0===o.response.count)Le(r,r,Ce);else if(void 0===l.find((function(e){return e.title===r})))Le(r,r,Ce);else{var i=l.find((function(e){return e.title===r})).id;i,Ge(i,Ce)}break;case"createAlbum":o.response.id,Ge(o.response.id,Ce);break;case"photoUrl":He(o.response.upload_url,n,Ce,o.response.album_id);break;case"photoSave":c="photo".concat(o.response[0].group_id,"_").concat(o.response[0].id),qe();break;case"sendWall":P(null),ae("sendResult"),ke(""),me(null);break;case"getGroup":P(null),Ie(o.response[0]);break;default:console.log(a)}break;default:console.log(a)}})),function(){t.apply(this,arguments)}(),xe(),Ne(),window.addEventListener("scroll",ze),function(){window.removeEventListener("scroll",ze)}}),[]);var ze=function(e){var t=e.currentTarget.scrollY,a=window.innerHeight;a+t>.7*Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)&&Se&&a+1e3<t&&(Se=!1,Te())},Ue=function(e){b(e.currentTarget.dataset.to)},Te=function(){var e=Object(f.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:P(r.a.createElement(v.a,{size:"large"})),ve.a.send("VKWebAppCallAPIMethod",{method:"wall.get",request_id:"getPostsAdd",params:{filters:"post",owner_id:"-".concat("113161053"),count:50,v:"5.105",access_token:Pe,lang:R,offset:Ke}}).then((function(e){B(D.concat(e.response.items)),Ke+=30,P(null),setTimeout((function(){return Se=!0}),4e3)})).catch((function(e){}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),xe=function(){d.a.send("VKWebAppCallAPIMethod",{method:"wall.get",request_id:"getPosts",params:{filters:"post",owner_id:"-".concat("113161053"),count:30,v:"5.105",access_token:Pe,lang:R}})},Ne=function(){d.a.send("VKWebAppCallAPIMethod",{method:"groups.getById",request_id:"getGroup",params:{fields:"description",group_ids:"".concat("113161053"),v:"5.105",access_token:Pe,lang:R}})},Re=function(){d.a.send("VKWebAppCallAPIMethod",{method:"messages.isMessagesFromGroupAllowed",request_id:"checkMessage",params:{user_id:ye,group_id:"113161053",v:"5.105",access_token:"e85c766c364f7ab9730b777f847d14a5790fcaf01578f45ac58398a39256c319db836c857ac0f990db1ec"}})},qe=function(){var e="".concat(c),t=Math.floor(1e9+Math.random()*(9e9+1-1e9)),a=+new Date,n=Math.round(a/1e3)+86400;d.a.send("VKWebAppCallAPIMethod",{method:"wall.post",request_id:"sendWall",params:{owner_id:"-".concat("113161053"),from_group:"1",signed:"0",message:o,attachments:e,publish_date:+n,guid:t,v:"5.103",access_token:"16ac9fa774aa9ccb80fc5f083a19e0f2aa6cb6da5044cc08078ca5085d0db198b24a8ef7a9bd68515b65f"}})},Fe=r.a.createElement(pe.a,{activeModal:te},r.a.createElement(de.a,{id:"subscription",onClose:function(){return ae(null)},icon:r.a.createElement(L.a,{src:Ve&&Ve.photo_50,size:72}),caption:r.a.createElement("span",null,r.a.createElement("h1",null,Ve&&Ve.name),"\u041c\u0438\u043d\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u043f\u0440\u0435\u0434\u043b\u0430\u0433\u0430\u0435\u0442 \u0412\u0430\u043c ",r.a.createElement("br",null)," \u043f\u043e\u0434\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f \u043d\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u0441\u0442\u0432\u043e"),actions:[{title:"\u041f\u043e\u0434\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f",mode:"primary",action:function(){d.a.send("VKWebAppJoinGroup",{group_id:113161053}),ae(null)}}],actionsLayout:"vertical"}),r.a.createElement(de.a,{id:"sendPost",onClose:function(){return ae(null)}},r.a.createElement(C.a,null,r.a.createElement("h1",null,"\u041f\u0440\u0435\u0434\u043b\u043e\u0436\u0438\u0442\u044c \u043d\u043e\u0432\u043e\u0441\u0442\u044c"),r.a.createElement(he.a,{className:"margin-bottom",value:Ee,onChange:function(e){ke(e.currentTarget.value),o=e.currentTarget.value},placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442 \u043d\u043e\u0432\u043e\u0441\u0442\u0438"}),r.a.createElement(ge.a,{top:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"margin-bottom",before:r.a.createElement(q.a,null),size:"l",onChange:function(e){var t=e.currentTarget.files[0];n=e.currentTarget.files[0];var a=new FileReader;a.readAsDataURL(t),a.onloadend=function(){me(a.result)}}},"\u041f\u0440\u0438\u043a\u0440\u0435\u043f\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443"),ue&&r.a.createElement("img",{className:"margin-bottom modal-img",src:ue,alt:"img"}),r.a.createElement(O.a,{mode:"secondary",size:"xl",disabled:!Ee,onClick:function(){return ae(null),P(r.a.createElement(v.a,{size:"large"})),void(null===ue?qe():Ye())}},"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"))),r.a.createElement(de.a,{id:"sendResult",onClose:function(){return ae(null)},actions:[{title:"\u041e\u0442\u043b\u0438\u0447\u043d\u043e!",mode:"primary",action:function(){ae(null)}}]},r.a.createElement(C.a,null,r.a.createElement("h1",null,"\u041d\u043e\u0432\u043e\u0441\u0442\u044c \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430!")))),Ge=function(e,t){d.a.send("VKWebAppCallAPIMethod",{method:"photos.getUploadServer",request_id:"photoUrl",params:{album_id:e,v:"5.103",access_token:t}})},He=function(e,t,a,n){var c=new FormData;c.append("photo",t);fetch("https://cors-anywhere.herokuapp.com/"+e,{method:"POST",body:c,headers:{"Access-Control-Allow-Origin":"*"}}).then((function(e){return e.json()})).then((function(e){e&&De(e.server,e.photos_list,e.hash,a,n)})).catch((function(e){}))},De=function(e,t,a,n,c){d.a.send("VKWebAppCallAPIMethod",{method:"photos.save",request_id:"photoSave",params:{album_id:c,server:e,photos_list:t,hash:a,v:"5.101",access_token:n}})},Be=function(e,t){d.a.send("VKWebAppCallAPIMethod",{method:"photos.getAlbums",request_id:"userAlbums",params:{owner_id:e,v:"5.103",access_token:t}})},Le=function(e,t,a){d.a.send("VKWebAppCallAPIMethod",{method:"photos.createAlbum",request_id:"createAlbum",params:{title:e,description:t,v:"5.103",access_token:a}})},Ye=function(){d.a.send("VKWebAppGetAuthToken",{app_id:7138591,scope:"photos"})};return r.a.createElement(S.a,{activeStory:a,tabbar:r.a.createElement(V.a,null,r.a.createElement(z.a,{onClick:function(){return l("post")},selected:"post"===a},r.a.createElement(T.a,null)),r.a.createElement(z.a,{onClick:function(){return l("catalog")},selected:"catalog"===a},r.a.createElement(N.a,null)))},r.a.createElement(g.a,{activePanel:m,popout:M,id:"post",modal:Fe},r.a.createElement(ee,{id:"home",fetchedUser:_,go:Ue,setPopout:P,lang:R,postArr:D,offset:Ke,groupInfo:Ve,showPhoto:function(e){X(e),b("photo")},getPosts:xe,setActiveModal:ae}),r.a.createElement(ie,{id:"photo",go:Ue,photo:Q})),r.a.createElement(g.a,{activePanel:"people",popout:M,id:"catalog"},r.a.createElement(Me,{setPopout:P,id:"people",fetchedUser:_,go:Ue,userArr:W,lang:R,checkMessage:oe,setcheckMessage:se,isMessagesFromGroupAllowed:Re})))};d.a.send("VKWebAppInit"),i.a.render(r.a.createElement(We,null),document.getElementById("root"))}},[[208,1,2]]]);
//# sourceMappingURL=main.baf23ae2.chunk.js.map